import flixel.FlxG;
import funkin.ui.mainmenu.MainMenuState;
import funkin.play.PlayState;
import funkin.Paths;
import funkin.util.WindowUtil;
import funkin.util.Constants;
import funkin.modding.module.Module;

import CustomIcon;

class MenuThings extends Module
{
    // Base code for custom window icon by @ComedyLost

    public var exeDESKTOP_VERSION:String = '0.3.0';
    public var windowTitle:String = 'Friday Night Funkin\': Vs. Sonic.exe'; // edit

    public var exeSongs:Array<String> = [ // I hate this
        "too-slow", "you-cant-run", "triple-trouble", "final-escape",
        "endless", "cycles", "execution", "faker", "black-sun", "relax",
        "chaos", "round-a-bout", "spike-trap", "prey", "fight-or-flight",
        "fatality", "slaybells", "personnel-serious"
    ];

    public function new()
    {
        super('MenuThings');
    }

    function doCustomWindow():Void {
        if (FlxG.state is PlayState) {
            if (exeSongs.indexOf(PlayState.instance.currentSong.id.toLowerCase()) != -1)
            {
                CustomIcon.setIcon(Paths.image('exeIcon'));
                WindowUtil.setWindowTitle(windowTitle);
            } else {
                WindowUtil.setWindowTitle(Constants.TITLE);
                CustomIcon.setIcon(Paths.image('icon16'));
            }
        }
    }
  
    override function onUpdate(event:UpdateScriptEvent)
    {
	    super.onUpdate(event);

        doCustomWindow();

        if (FlxG.state is MainMenuState)
        {
            FlxG.state.rightWatermarkText.text = "SONIC.EXE V-SLICE v" + exeDESKTOP_VERSION;
        }
    }
}